{% extends "base.html" %}
{% load cms_tags sekizai_tags menu_tags message_tags %}
{% block tools %}
    <div class="tools">
        <div class="holder">
            <div class="frame">
                <h1>搜索结果:{{ search_context }}</h1>

                <div id="is_attachment_search" style="display: none">1</div>
                <div style="display: none" id="search_result">{{ search_context }}</div>

                <p class="breadcrumb">
                    <a href="{% page_url 'cms_home' %}">首页</a>
                </p>
            </div>
        </div>
    </div>
    <br/>
{% endblock %}
{% block content %}
    <div id="horizontal_nav">
        <ul class="sub-menu">
            <li><a href="{% url search search_context=search_context %}"><span style="font-size: 18px">消息</span></a></li>
            <li><a href="{% url project_search search_context=search_context %}"><span style="font-size: 18px">项目</span></a></li>
            <li class="current_page_item"><a><span style="font-size: 18px">文档</span></a></li>
        </ul>
    </div>
    {% if messages %}
        <div class="karma-pages-top">
            <span class="pages"> 第<strong> {{ messages.number }} </strong>页/ 共{{ messages.paginator.num_pages }}页</span>
            每页20条&nbsp;&nbsp;&nbsp;&nbsp;共{{ messages.paginator.count }}条&nbsp;&nbsp;&nbsp;&nbsp;
            <a style="background: none;" href="?page=1">首页</a>
            {% if messages.has_previous %}
                <a style="background: none;" href="?page={{ messages.previous_page_number }}">上一页</a>
            {% endif %}
            {% if messages.has_next %}
                <a style="background: none;" href="?page={{ messages.next_page_number }}">下一页</a>
            {% endif %}
            <a style="background: none;" href="?page={{ messages.paginator.num_pages }}">尾页</a>
            跳转到<input id="jump_to_page_top"/>页
            <button id="jump_to_top">go</button>
        </div>
        <table class="category_table">
            <thead>
            <tr>
                <th>名称</th>
                <th>文件夹</th>
                <th>创建日期</th>
            </tr>
            </thead>
            <tbody>


            {% for msg in messages %}

                <tr>
                    <td>
                        <a target="_blank" href="{{ erp_address }}#id={{ msg.id }}&view_type=form&model=ir.attachment"
                           title="{{ msg.name }}"><span style='color: #ba2636'>·&nbsp;</span> {{ msg.name }} </a>
                    </td>
                    <td style="text-align: center">
                        {% if msg.parent_id %}
                            {{ msg.parent_id|safe }}
                        {% endif %}
                    </td>
                    <td style="text-align: center">
                        {% if msg.create_date %}
                            {{ msg.create_date|safe }}
                        {% endif %}
                    </td>
                </tr>
            {% endfor %}
            </tbody>
        </table>

    {% else %}
        无相关搜索结果
    {% endif %}

    <div class="karma-pages">
        <span class="pages"> 第<strong> {{ messages.number }} </strong>页/ 共{{ messages.paginator.num_pages }}页</span>
        每页20条&nbsp;&nbsp;&nbsp;&nbsp;共{{ messages.paginator.count }}条&nbsp;&nbsp;&nbsp;&nbsp;
        <a style="background: none;" href="?page=1">首页</a>
        {% if messages.has_previous %}
            <a style="background: none;" href="?page={{ messages.previous_page_number }}">上一页</a>
        {% endif %}
        {% if messages.has_next %}
            <a style="background: none;" href="?page={{ messages.next_page_number }}">下一页</a>
        {% endif %}
        <a style="background: none;" href="?page={{ messages.paginator.num_pages }}">尾页</a>
        跳转到<input id="jump_to_page_bottom">页
        <button id="jump_to_bottom">go</button>
    </div>
{% endblock %}

{% block custom_js %}
    <script>
        $(function () {
            $('#jump_to_bottom').bind("click", function (event) {
                var reg = new RegExp("^[0-9]+$");
                event.preventDefault();
                var pageNum = $("#jump_to_page_bottom")[0].value;
                if (reg.test(pageNum)) {
                    window.location.href = '?page=' + encodeURIComponent(pageNum)
                } else {
                    alert("请输入数字！")
                }
            })
            $('#jump_to_top').bind("click", function (event) {
                var reg = new RegExp("^[0-9]+$");
                event.preventDefault();
                var pageNum = $("#jump_to_page_top")[0].value;
                if (reg.test(pageNum)) {
                    window.location.href = '?page=' + encodeURIComponent(pageNum)
                } else {
                    alert("请输入数字！")
                }
            })
        })
    </script>
{% endblock %}